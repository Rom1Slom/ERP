{% extends "habilitations_app/base.html" %}
{% block title %}Invitations Clients{% endblock %}
{% block page_content %}
<div class="container mt-4">
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h3>Invitations envoyées</h3>
    <a href="{% url 'creer_entreprise_et_invitation' %}" class="btn btn-primary">
      <i class="bi bi-plus-circle"></i> Nouvelle invitation
    </a>
  </div>
  <div class="card p-3">
    <div class="table-responsive">
      <table class="table table-striped">
        <thead>
          <tr>
            <th>PME</th>
            <th>Email contact</th>
            <th>Statut</th>
            <th>Créée le</th>
            <th>Expiration</th>
          </tr>
        </thead>
        <tbody>
          {% for inv in invitations %}
          <tr>
            <td>{{ inv.entreprise_client.nom }}</td>
            <td>{{ inv.email_contact }}</td>
            <td>
              {% if inv.statut == 'pending' %}
                <span class="badge bg-warning">En attente</span>
              {% elif inv.statut == 'accepted' %}
                <span class="badge bg-success">Acceptée</span>
              {% else %}
                <span class="badge bg-secondary">Expirée</span>
              {% endif %}
            </td>
            <td>{{ inv.date_created|date:"d/m/Y H:i" }}</td>
            <td>
              {% if inv.expires_at %}
                {{ inv.expires_at|date:"d/m/Y H:i" }}
                {% if inv.is_expired %}
                  <span class="badge bg-danger ms-2">Expirée</span>
                {% endif %}
              {% else %}
                —
              {% endif %}
            </td>
          </tr>
          {% empty %}
          <tr>
            <td colspan="5" class="text-center text-muted">Aucune invitation pour le moment.</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
</div>
{% endblock %}